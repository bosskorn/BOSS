<!DOCTYPE html>
<html>
<head>
  <title>ทดสอบการพิมพ์บาร์โค้ด</title>
  <meta charset="UTF-8">
  <script src="https://unpkg.com/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
  <style>
    body { 
      font-family: 'Kanit', 'Sarabun', sans-serif; 
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header h1 {
      color: #8A2BE2;
      margin-bottom: 5px;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 30px;
    }
    .option {
      flex: 1;
      min-width: 300px;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 20px;
      background-color: #f9f9f9;
    }
    .option h2 {
      margin-top: 0;
      color: #8A2BE2;
    }
    .button {
      background-color: #8A2BE2;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      display: inline-block;
      margin-top: 10px;
    }
    .button:hover {
      background-color: #7209b7;
    }
    .barcode-display {
      border: 1px solid #ddd;
      padding: 20px;
      text-align: center;
      background-color: white;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    
    /* สไตล์สำหรับหน้าต่างการพิมพ์ */
    @media print {
      body {
        margin: 0;
        padding: 0;
      }
      .no-print {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ทดสอบการพิมพ์บาร์โค้ดสำหรับลาเบล</h1>
      <p>ใช้หน้านี้เพื่อทดสอบการสร้างและพิมพ์บาร์โค้ดด้วย JsBarcode</p>
    </div>
    
    <div class="barcode-display">
      <h3>ตัวอย่างบาร์โค้ด</h3>
      <svg id="sample-barcode" width="300px" height="80px"></svg>
      <div style="margin-top: 10px; font-family: monospace;">TMP5079863352</div>
    </div>
    
    <div class="options">
      <div class="option">
        <h2>1. บาร์โค้ดอย่างเดียว</h2>
        <p>พิมพ์เฉพาะบาร์โค้ดโดยไม่มีข้อมูลอื่น</p>
        <button class="button" onclick="printBarcodeOnly()">พิมพ์บาร์โค้ด</button>
      </div>
      
      <div class="option">
        <h2>2. ลาเบลจัดส่ง 100x75mm</h2>
        <p>พิมพ์ลาเบลจัดส่งพร้อมบาร์โค้ด ขนาด 100 x 75 มม.</p>
        <button class="button" onclick="printShippingLabel()">พิมพ์ลาเบลจัดส่ง</button>
      </div>
    </div>
  </div>
  
  <script>
    const trackingNumber = "TMP5079863352";
    
    // สร้างบาร์โค้ดตัวอย่างเมื่อโหลดหน้า
    window.onload = function() {
      JsBarcode("#sample-barcode", trackingNumber, {
        format: "CODE128",
        width: 2,
        height: 60,
        displayValue: false,
        margin: 0
      });
    };
    
    // ฟังก์ชันพิมพ์บาร์โค้ดอย่างเดียว
    function printBarcodeOnly() {
      const printWindow = window.open('', '_blank');
      if (!printWindow) {
        alert('ไม่สามารถเปิดหน้าต่างพิมพ์ได้ โปรดตรวจสอบว่าไม่ได้ถูกบล็อกป๊อปอัพ');
        return;
      }
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>พิมพ์บาร์โค้ด</title>
          <script src="https://unpkg.com/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
          <style>
            @page { size: auto; margin: 10mm; }
            body { margin: 0; padding: 0; }
            .barcode-container { text-align: center; margin: 20px; }
            .print-button { text-align: center; margin: 20px; }
            .print-button button { 
              padding: 10px 20px; 
              background: #8A2BE2; 
              color: white; 
              border: none; 
              border-radius: 4px;
              cursor: pointer;
            }
            @media print {
              .print-button { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="print-button">
            <button onclick="window.print();">พิมพ์บาร์โค้ด</button>
          </div>
          <div class="barcode-container">
            <svg id="barcode"></svg>
            <div style="font-family: monospace; margin-top: 5px;">${trackingNumber}</div>
          </div>
          <script>
            window.onload = function() {
              try {
                JsBarcode("#barcode", "${trackingNumber}", {
                  format: "CODE128",
                  width: 2,
                  height: 50,
                  displayValue: false
                });
                console.log("Barcode generated successfully");
              } catch (error) {
                console.error("Error generating barcode:", error);
                document.body.innerHTML += '<div style="color:red;text-align:center;margin:20px;">เกิดข้อผิดพลาดในการสร้างบาร์โค้ด: ' + error + '</div>';
              }
            };
          </script>
        </body>
        </html>
      `);
      
      printWindow.document.close();
    }
    
    // ฟังก์ชันพิมพ์ลาเบลจัดส่ง
    function printShippingLabel() {
      const printWindow = window.open('', '_blank');
      if (!printWindow) {
        alert('ไม่สามารถเปิดหน้าต่างพิมพ์ได้ โปรดตรวจสอบว่าไม่ได้ถูกบล็อกป๊อปอัพ');
        return;
      }
      
      printWindow.document.write(`
        <!DOCTYPE html>
        <html>
        <head>
          <title>พิมพ์ลาเบลจัดส่ง</title>
          <script src="https://unpkg.com/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
          <style>
            @page { size: 100mm 75mm; margin: 0; }
            body { 
              margin: 0; 
              padding: 0; 
              font-family: Arial, sans-serif;
            }
            .label-container {
              width: 100mm;
              height: 75mm;
              padding: 5mm;
              box-sizing: border-box;
            }
            .header {
              text-align: center;
              font-size: 16px;
              font-weight: bold;
              color: #8A2BE2;
              margin-bottom: 3mm;
            }
            .tracking-box {
              border: 1px solid #8A2BE2;
              background-color: #f5f0ff;
              padding: 2mm;
              margin-bottom: 3mm;
              text-align: center;
              font-weight: bold;
            }
            .flex-row {
              display: flex;
              margin-bottom: 3mm;
            }
            .col {
              flex: 1;
            }
            .col-right {
              border-left: 1px solid #eee;
              padding-left: 2mm;
            }
            .label {
              font-size: 9px;
              font-weight: bold;
              background-color: #f5f5f5;
              padding: 1mm;
            }
            .address-box {
              border: 1px solid #eee;
              padding: 1.5mm;
              font-size: 9px;
              line-height: 1.2;
            }
            .barcode-box {
              background-color: #f9f9f9;
              border: 1px solid #eee;
              padding: 2mm;
              margin-top: 2mm;
              text-align: center;
            }
            .cod-box {
              background-color: #fff5f5;
              text-align: center;
              padding: 1mm;
              font-size: 9px;
              margin-top: 2mm;
            }
            .print-button {
              text-align: center;
              margin: 20px;
            }
            .print-button button {
              padding: 10px 20px;
              background-color: #8A2BE2;
              color: white;
              border: none;
              border-radius: 4px;
              cursor: pointer;
            }
            @media print {
              .print-button { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="print-button">
            <button onclick="window.print();">พิมพ์ลาเบล</button>
          </div>
          
          <div class="label-container">
            <div class="header">PURPLEDASH</div>
            
            <div class="tracking-box">${trackingNumber}</div>
            
            <div class="flex-row">
              <div class="col">
                <div class="label">ผู้ส่ง</div>
                <div class="address-box">
                  <strong>PURPLEDASH</strong><br>
                  123 ถนนพระราม 9<br>
                  แขวงบางกะปิ เขตห้วยขวาง<br>
                  กรุงเทพฯ 10310<br>
                  โทร: 02-123-4567
                </div>
              </div>
              
              <div class="col col-right">
                <div class="label">ผู้รับ</div>
                <div class="address-box">
                  <strong>คุณลูกค้า ทดสอบ</strong><br>
                  789 ถนนสุขุมวิท<br>
                  แขวงคลองตัน เขตวัฒนา<br>
                  กรุงเทพฯ 10110<br>
                  โทร: 081-234-5678
                </div>
              </div>
            </div>
            
            <div class="barcode-box">
              <div style="font-size: 8px; color: #555; margin-bottom: 1mm;">บาร์โค้ด</div>
              <svg id="barcode" width="90%" height="30px"></svg>
              <div style="font-size: 9px; font-family: monospace; margin-top: 1mm;">${trackingNumber}</div>
            </div>
            
            <div class="cod-box">
              เก็บเงินปลายทาง: 500.00 บาท
            </div>
          </div>
          
          <script>
            window.onload = function() {
              try {
                JsBarcode("#barcode", "${trackingNumber}", {
                  format: "CODE128",
                  width: 1.5,
                  height: 30,
                  displayValue: false,
                  margin: 0
                });
                console.log("Barcode generated successfully");
                
                // พิมพ์อัตโนมัติหลังจากสร้างบาร์โค้ดเสร็จ 1 วินาที
                setTimeout(function() {
                  window.print();
                }, 1000);
                
              } catch (error) {
                console.error("Error generating barcode:", error);
                document.body.innerHTML += '<div style="color:red;text-align:center;margin:20px;">Error generating barcode: ' + error + '</div>';
              }
            };
          </script>
        </body>
        </html>
      `);
      
      printWindow.document.close();
    }
  </script>
</body>
</html>
